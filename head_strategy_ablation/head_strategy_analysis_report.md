# Head Strategy Evaluation Results Analysis

评估时间: Fri 19 Sep 2025
方法: ablation_a
测试Token数量: 192, 128, 64
测试Head数量: 24, 16, 8
测试策略: max_attention, attention_range, sparsity, top_k_sum, multi_objective, graph_based, hierarchical

## TextVQA评估结果

| Token | Head | attention_range | graph_based | hierarchical | max_attention | multi_objective | sparsity | top_k_sum |
|---|---|---|---|---|---|---|---|---|
| **192** | 24 | 57.65% | 57.61% | 57.44% | 57.59% | 57.52% | **57.67%** | 57.55% |
|  | 16 | 57.53% | 57.55% | 57.54% | 57.54% | 57.53% | **58.02%** | 57.46% |
|  | 8 | 57.07% | **57.52%** | - | 57.11% | 57.13% | 57.52% | 57.10% |
| **128** | 24 | 56.20% | 56.58% | 56.31% | 56.22% | 56.08% | **56.75%** | 56.34% |
|  | 16 | 56.64% | 56.48% | **56.66%** | 56.62% | 55.91% | 56.62% | 56.39% |
|  | 8 | 56.04% | **56.33%** | - | 56.06% | 55.41% | 55.64% | 56.00% |
| **64** | 24 | 51.53% | **52.13%** | 51.61% | 51.59% | 51.46% | 51.40% | 51.58% |
|  | 16 | 51.73% | 51.73% | 51.46% | 51.71% | **52.17%** | 51.61% | 51.53% |
|  | 8 | 51.52% | **51.75%** | - | 51.52% | 51.37% | 51.28% | 51.34% |

## MME评估结果

| Token | Head | attention_range | graph_based | hierarchical | max_attention | multi_objective | sparsity | top_k_sum |
|---|---|---|---|---|---|---|---|---|
| **192** | 24 | 1809.1 | 1817.8 | 1822.5 | 1809.1 | 1809.3 | **1832.5** | 1805.2 |
|  | 16 | 1842.4 | 1827.5 | 1820.5 | 1842.4 | 1794.6 | **1853.7** | 1839.4 |
|  | 8 | 1819.9 | 1820.5 | - | 1812.4 | 1777.7 | 1810.2 | **1829.8** |
| **128** | 24 | 1707.7 | 1678.8 | 1724.8 | 1703.2 | 1696.3 | **1752.6** | 1683.8 |
|  | 16 | 1728.0 | 1707.4 | 1728.4 | 1724.8 | 1639.0 | **1743.2** | 1704.8 |
|  | 8 | 1700.4 | 1702.0 | - | 1704.6 | 1580.4 | 1643.6 | **1731.3** |
| **64** | 24 | 1301.0 | 1318.5 | 1306.5 | 1306.9 | 1302.3 | **1318.9** | 1315.0 |
|  | 16 | **1386.7** | 1350.1 | 1306.0 | 1383.8 | 1286.2 | 1329.3 | 1349.1 |
|  | 8 | 1360.3 | **1391.1** | - | 1356.4 | 1238.7 | 1327.3 | 1390.5 |

## GQA评估结果

| Token | Head | attention_range | graph_based | hierarchical | max_attention | multi_objective | sparsity | top_k_sum |
|---|---|---|---|---|---|---|---|---|
| **192** | 24 | 57.03% | 57.17% | 57.08% | 56.90% | 57.01% | **57.51%** | 57.00% |
|  | 16 | 57.64% | 57.28% | **57.78%** | 57.65% | 56.45% | 57.57% | 57.27% |
|  | 8 | 57.43% | 57.18% | 54.01% | 57.43% | 56.47% | 56.82% | **57.47%** |
| **128** | 24 | 54.03% | 54.26% | 54.33% | - | 53.90% | **54.52%** | 54.01% |
|  | 16 | 55.39% | 55.00% | 55.37% | **55.41%** | 52.99% | 55.11% | 54.85% |
|  | 8 | 54.54% | 54.60% | 46.73% | 54.47% | 52.45% | 53.38% | **54.68%** |
| **64** | 24 | 46.80% | **47.29%** | 46.66% | - | 46.25% | 46.18% | 46.73% |
|  | 16 | 47.45% | **47.71%** | 46.96% | 47.34% | 45.75% | 46.57% | 46.84% |
|  | 8 | 47.15% | **47.55%** | - | 47.16% | 45.42% | 45.98% | 47.20% |

## POPE评估结果

| Token | Head | attention_range | graph_based | hierarchical | max_attention | multi_objective | sparsity | top_k_sum |
|---|---|---|---|---|---|---|---|---|
| **192** | 24 | 75.16% | 75.66% | 76.00% | 75.12% | 75.17% | **76.64%** | 75.61% |
|  | 16 | 76.84% | 75.37% | **77.15%** | 76.79% | 74.10% | 76.95% | 75.98% |
|  | 8 | **76.58%** | 76.13% | 67.88% | 76.58% | 73.52% | 74.14% | 76.52% |
| **128** | 24 | 68.16% | 68.34% | 68.54% | - | 67.94% | **69.09%** | 67.78% |
|  | 16 | **70.79%** | 68.45% | 70.73% | 70.68% | 64.26% | 70.75% | 69.70% |
| **64** | 24 | 37.36% | **38.97%** | 36.08% | 37.35% | 37.60% | 38.41% | 37.27% |
|  | 16 | 41.84% | **43.72%** | 38.09% | 41.76% | 32.77% | 40.62% | 40.06% |
|  | 8 | 38.89% | **44.76%** | - | 38.89% | 28.61% | 35.51% | 39.46% |

## 主要发现

### 各评估指标最佳配置

- **TextVQA**: Token=192, Head=16, Strategy=sparsity → 58.02%
- **MME**: Token=192, Head=16, Strategy=sparsity → 1853.7
- **GQA**: Token=192, Head=16, Strategy=hierarchical → 57.78%
- **POPE**: Token=192, Head=16, Strategy=hierarchical → 77.15%

### Head Selection策略分析

根据每行最优结果的统计分析：

**策略优势分析：**
- **sparsity**: 在 13 个配置中表现最佳
- **graph_based**: 在 10 个配置中表现最佳
- **top_k_sum**: 在 4 个配置中表现最佳
- **hierarchical**: 在 3 个配置中表现最佳
- **attention_range**: 在 2 个配置中表现最佳
- **max_attention**: 在 2 个配置中表现最佳
- **multi_objective**: 在 1 个配置中表现最佳

**策略特点：**
- **sparsity**: 在高token数(192,128)和较多head数(24,16)时表现最佳，是计算效率和性能的好平衡
- **graph_based**: 在低token数(64)时表现突出，特别适合资源受限场景
- **top_k_sum**: 在8个head的配置下经常是最优选择，适合极度压缩的场景
- **hierarchical**: 在特定高质量配置(192/16)下表现优异，特别是推理类任务

### 每个配置的最优策略详细分析

#### TextVQA最优策略：
- **192/24**: sparsity (57.67%)
- **192/16**: sparsity (58.02%)
- **192/8**: graph_based/sparsity (57.52%, 并列)
- **128/24**: sparsity (56.75%)
- **128/16**: hierarchical (56.66%)
- **128/8**: graph_based (56.33%)
- **64/24**: graph_based (52.13%)
- **64/16**: multi_objective (52.17%)
- **64/8**: graph_based (51.75%)

#### MME最优策略：
- **192/24**: sparsity (1832.5)
- **192/16**: sparsity (1853.7)
- **192/8**: top_k_sum (1829.8)
- **128/24**: sparsity (1752.6)
- **128/16**: sparsity (1743.2)
- **128/8**: top_k_sum (1731.3)
- **64/24**: sparsity (1318.9)
- **64/16**: attention_range (1386.7)
- **64/8**: graph_based (1391.1)

#### GQA最优策略：
- **192/24**: sparsity (57.51%)
- **192/16**: hierarchical (57.78%)
- **192/8**: top_k_sum (57.47%)
- **128/24**: sparsity (54.52%)
- **128/16**: max_attention (55.41%)
- **128/8**: top_k_sum (54.68%)
- **64/24**: graph_based (47.29%)
- **64/16**: graph_based (47.71%)
- **64/8**: graph_based (47.55%)

#### POPE最优策略：
- **192/24**: sparsity (76.64%)
- **192/16**: hierarchical (77.15%)
- **192/8**: attention_range/max_attention (76.58%, 并列)
- **128/24**: sparsity (69.09%)
- **128/16**: attention_range (70.79%)
- **64/24**: graph_based (38.97%)
- **64/16**: graph_based (43.72%)
- **64/8**: graph_based (44.76%)

### 推荐配置

**根据资源约束的推荐策略：**

1. **充足资源场景** (Token≥192, Head≥16):
   - 推荐策略: **sparsity** (在24/16 head配置下最优) 或 **hierarchical** (在16 head推理任务下最优)
   - 理由: sparsity在大多数情况下表现最佳，hierarchical在推理类任务(GQA/POPE)中表现突出

2. **中等资源场景** (Token=128):
   - **24 heads**: **sparsity** (3/4个基准最优)
   - **16 heads**: **sparsity/hierarchical/max_attention/attention_range** (根据任务类型选择)
   - **8 heads**: **top_k_sum** (2/4个基准最优)

3. **受限资源场景** (Token≤64):
   - 推荐策略: **graph_based** (在低资源下最稳定，6/9个配置最优)
   - 备选: **multi_objective** (在64/16配置下有优势)

**总体推荐策略选择指南:**
- **性能优先**: sparsity (高资源) → graph_based (低资源)
- **推理任务优先**: hierarchical (192/16) → graph_based (64/*)
- **极限压缩**: top_k_sum (*/8) → graph_based (64/*)